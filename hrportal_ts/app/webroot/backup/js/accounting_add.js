$(document).ready(function() {      $('.account-heads-input').keyup(function(){            if($(this).val()!='')                {                      $(".account-heads-input").css('border','none');                }         });    });var globalExpense = 0;var rowcount=0;function CheckPreviousAddRow(obj){   lastTrObj = $(obj).find('.exp-voucher').find('tr:last');     totalrowfound = $(obj).find('.exp-voucher').find('tr').length-1;      $("#loaderbtn").empty().html("<img src='../img/ajax-loader.gif' style='height:24px;'/>");   $.ajax({            type: 'POST',            data: {totalrowfound:totalrowfound},            url: "accountingrow",            success: function(data)            {                $(lastTrObj).after(data);                                document.getElementById("remove_button").disabled=false;                                rowcount++;                              $("#loaderbtn").empty().html();              }    });  }     /*============================ ADD THE ACCOUNTING PAGE FOR REMOVE THE ROW  ============================*/		        function RemoveRow(obj)        {               var totalrowfound = $(obj).find('.exp-voucher').find('tr').length - 1;            var hiddenvalue   = $("#findTotalRow").val() ;            if(hiddenvalue==0)             {                 var rowlimit=1;             }else{                 var rowlimit=hiddenvalue;             }               if (  totalrowfound != rowlimit ) {                                    $(obj).find('.exp-voucher').find('tr:last').remove();                rowcount--;                       }else{                 alert('You can not remove beyond this limit !');            }                        }         /*============================ ADD THE ACCOUNTING PAGE FOR CHECK THE VALIDATION FOR REGION,  * ============================YEAR BY CURRENCY CHECK TARGET MASTER TABLE  ============================*/   function resetRegionCurrency(obj)         {            var obj= obj ;            for(var j=0;j<=parseInt(rowcount);j++)                {                   jQuery("#currency_"+j).val('');                   $("#accountregion_"+j)[0].selectedIndex=0;            }         }           function CheckRegionByCurrencyList(obj,fieldid)         {            var obj= obj ;            var msg = '';            var year=$("#year").val();            var month=$("#month").val();            var region_id = jQuery("#accountregion_"+fieldid).val();            if (month == "0") {                 $("#accountregion_"+fieldid)[0].selectedIndex=0;                msg = 'Please select Month \n';                alert(msg);                return false;            }            if (year == "0") {                 $("#accountregion_"+fieldid)[0].selectedIndex=0;                msg = 'Please select Year \n';                alert(msg);                return false;            }        	$.ajax({            type: 'POST',            data: {region_id:region_id,fieldid:fieldid,year:year},            url: "getCurrency",            success: function(data) {			if(data==0)			{				//alert("Please specify currency in Target Master for corresponding region.");				// $("#accountregion_"+fieldid)[0].selectedIndex=0;                                jQuery("#currency_"+fieldid).val('Rs');				return true;			}else{				//jQuery("#currency_"+fieldid).val(data);                                 jQuery("#currency_"+fieldid).val('Rs');                             }            }        }); } /*============================ ADD THE ACCOUNTING PAGE FOR CHECK THE VALIDATION  ============================*/	function addsubmit(){    var check = vaildationAccountingFrom();    if(check==false)      {            return false;      }       $("#popupdialogaccountadd").dialog({             title: '',              buttons: {                "Yes": function() {                      $('#final').val('N');                     $( this ).dialog( "close" );                     var didconfirm = confirm("Are you sure you want to save?");                     if (didconfirm == false) {                        return false;                    }else{                        $('#accountingaddfrm').submit();                         return true;                    }                    },                "No": function() {                     $('#final').val('Y');                        $( this ).dialog( "close" );                     var didconfirm = confirm("Are you sure you want to save?");                     if (didconfirm == false) {                        return false;                    }else{                        $('#accountingaddfrm').submit();                         return true;                    }                    }              }            }); }                   function vaildationAccountingFrom() {            var hiddenvalue   = $("#findTotalRow").val() ;				if(parseInt(hiddenvalue)>0)				 {					 var totalrowfound = $("#accountingeditfrm").find('.exp-voucher').find('tr').length-2;					 rowcount= totalrowfound;				 } 				var msg = '';				if ($("#month").val() == "0") {					msg = 'Please select Month \n';					alert(msg);					return false;				}				if ($("#year").val() == "0") {					msg = 'Please select Year \n';					alert(msg);					return false;				}                 var regionValue=0;                 var hwRevenueNumValue=1;    				 var prodRevenueNumValue=1;  				 var serviceRevenueNumValue=1;                 var checkNewregionValue=1;         				 var hwRevenueValue=0;       				 var prodRevenueValue=0;     				 var serviceRevenueValue=0;                                   var regexp = /^-?\d*\.{0,1}\d+$/;                // var regexp =/(^[0-9][0-9]*$)/;     				 var interRegionRevenueNumValue=1;				 var interRegionExpNumValue=1;  				 var hwCostValueNumValue=1;                 var directIncomeValue=0;           				 var interRegionRevenueValue=0;       				 var interRegionExpValue=0;     				 var hwCostValueValue=0;                 var directIncomeNumValue=1;                 var expNumValue=1;   				 var indirectExpenseNumValue=1;    				 var indirectIncomeNumValue=1;  				 var directExpenceNumValue=1;                 var expValue=0;   				 var indirectExpenseValue=0;    				 var indirectIncomeValue=0;  				 var directExpenceValue=0;				 var hwCostValue=0                var man_day_IdValue=0;                var man_day_IdNumValue=1;                                var nuProductOutstandingValue=0;                var nuServiceOutstandingValue=0;                                 for(var j=0;j<=parseInt(rowcount);j++)                {                     var regionId =jQuery("#accountregion_"+j).val();                     if(regionId == 0)                        {	                                regionValue=0;                                 break;                        }else{ 	                                regionValue=1;                               for(var k=parseInt(j)+1;k<=parseInt(rowcount);k++)                                {                                       var newregionId =jQuery("#accountregion_"+k).val();                                                                      if(regionId == newregionId)                                     {                                         checkNewregionValue=0;                                         break;                                    }                                }                             }                    var direct_incomeId =jQuery("#direct_income_"+j).val();                        if(direct_incomeId=='')                        {                                $("#direct_income_"+j).css('border','1px solid red');                                $("#direct_income_"+j).focus();                                directIncomeValue=0;                                break;                        }                        else{                                 directIncomeValue=1;                                                                if(!regexp.test(direct_incomeId))                                    {                                        $("#direct_income_"+j).css('border','1px solid red');                                        $("#direct_income_"+j).focus();                                        $("#direct_income_"+j).val('');                                              directIncomeNumValue=0;                                        break                                    }                             }                                                var direct_expenceId =jQuery("#direct_expence_"+j).val();                        if(direct_expenceId=='')                        {                                $("#direct_expence_"+j).css('border','1px solid red');                                $("#direct_expence_"+j).focus();                                directExpenceValue=0;                                break;                        }                        else{                                 directExpenceValue=1;                                 if(!regexp.test(direct_expenceId))                                    {                                        $("#direct_expence_"+j).css('border','1px solid red');                                        $("#direct_expence_"+j).focus();                                        $("#direct_expence_"+j).val('');                                              directExpenceNumValue=0;                                        break                                    }                             }                    var indirect_incomeId =jQuery("#indirect_income_"+j).val();                            if(indirect_incomeId=='')                            {                                    $("#indirect_income_"+j).css('border','1px solid red');                                    $("#indirect_income_"+j).focus();                                    indirectIncomeValue=0;                                    break;                            }                            else{                                     indirectIncomeValue=1;                                    if(!regexp.test(indirect_incomeId))                                    {                                            $("#indirect_income_"+j).css('border','1px solid red');                                            $("#indirect_income_"+j).focus();                                            $("#indirect_income_"+j).val('');                                                  indirectIncomeNumValue=0;                                            break                                    }                                 }                                                  var indirect_expense_Id =jQuery("#indirect_expense_"+j).val();                                if(indirect_expense_Id=='')                                {                                       $("#indirect_expense_"+j).css('border','1px solid red');                                       $("#indirect_expense_"+j).focus();                                        indirectExpenseValue=0;                                        break;                                }                                else{                                         indirectExpenseValue=1;                                        if(!regexp.test(indirect_expense_Id))                                        {                                                $("#indirect_expense_"+j).css('border','1px solid red');                                                $("#indirect_expense_"+j).focus();                                                $("#indirect_expense_"+j).val('');                                                      indirectExpenseNumValue=0;                                                break                                        }                                    }                                      var hw_cost_Id =jQuery("#hw_cost_"+j).val();                                        if(hw_cost_Id=='')                                        {                                                $("#hw_cost_"+j).css('border','1px solid red');                                                $("#hw_cost_"+j).focus();	                                                hwCostValue=0;                                                break;                                        }                                        else{                                                         hwCostValue=1;                                                        if(!regexp.test(hw_cost_Id))                                                        {                                                                $("#hw_cost_"+j).css('border','1px solid red');                                                                $("#hw_cost_"+j).focus();	                                                                $("#hw_cost_"+j).val('');                                                                      hwCostValueNumValue=0;                                                                break                                                        }                                                 }                                                                    var inter_region_exp_Id =jQuery("#inter_region_exp_"+j).val();					                                     if(inter_region_exp_Id=='')                                    {                                            $("#inter_region_exp_"+j).css('border','1px solid red');                                            $("#inter_region_exp_"+j).focus();				                                                interRegionExpValue=0;                                            break;                                    }                                    else{                                                     interRegionExpValue=1;                                                    if(!regexp.test(inter_region_exp_Id))                                                    {                                                            $("#inter_region_exp_"+j).css('border','1px solid red');                                                            $("#inter_region_exp_"+j).focus();	                                                            $("#inter_region_exp_"+j).val('');                                                                  interRegionExpNumValue=0;                                                            break                                                    }                                             }                    var inter_region_revenue_Id =jQuery("#inter_region_revenue_"+j).val();                            if(inter_region_revenue_Id=='')                            {                                    $("#inter_region_revenue_"+j).css('border','1px solid red');                                    $("#inter_region_revenue_"+j).focus();                                    interRegionRevenueValue=0;                                    break;                            }                            else{                                     interRegionRevenueValue=1;                                    if(!regexp.test(inter_region_revenue_Id))                                    {                                            $("#inter_region_revenue_"+j).css('border','1px solid red');                                            $("#inter_region_revenue_"+j).focus();                                            $("#inter_region_revenue_"+j).val('');                                                  interRegionRevenueNumValue=0;                                            break                                    }                                 }                                                 var prod_revenue_Id =jQuery("#prod_revenue_"+j).val();                            if(prod_revenue_Id=='')                            {                                    $("#prod_revenue_"+j).css('border','1px solid red');                                    $("#prod_revenue_"+j).focus();                                    prodRevenueValue=0;                                    break;                            }                            else{                                     prodRevenueValue=1;                                    if(!regexp.test(prod_revenue_Id))                                    {                                            $("#prod_revenue_"+j).css('border','1px solid red');                                            $("#prod_revenue_"+j).focus();                                            $("#prod_revenue_"+j).val('');                                                  prodRevenueNumValue=0;                                            break                                    }                                 }                                   var service_revenue_Id =jQuery("#service_revenue_"+j).val();                            if(service_revenue_Id=='')                            {                                    serviceRevenueValue=0;                                    break;                            }                            else{                                     serviceRevenueValue=1;                                    if(!regexp.test(service_revenue_Id))                                    {                                            $("#service_revenue_"+j).css('border','1px solid red');                                            $("#service_revenue_"+j).focus();                                            $("#exp_"+j).val('');                                                  serviceRevenueNumValue=0;                                            break                                    }                                  }                    var hw_revenue_Id =jQuery("#hw_revenue_"+j).val();                            if(hw_revenue_Id=='')                            {                                     $("#hw_revenue_"+j).css('border','1px solid red');                                     $("#hw_revenue_"+j).focus();                                    hwRevenueValue=0;                                    break;                            }                            else{                                     hwRevenueValue=1;                                    if(!regexp.test(hw_revenue_Id))                                    {                                           $("#hw_revenue_"+j).css('border','1px solid red');                                           $("#hw_revenue_"+j).focus();                                           $("#hw_revenue_"+j).val('');                                                  hwRevenueNumValue=0;                                            break                                    }                                 }                                                                                   var man_day_Id =jQuery("#nu_man_day_"+j).val();                            if(man_day_Id=='')                            {                                 $("#nu_man_day_"+j).css('border','1px solid red');                                 $("#nu_man_day_"+j).focus();                                  man_day_IdValue=0;                                    break;                            }                            else{                                     man_day_IdValue=1;                                    if(!regexp.test(man_day_Id))                                    {                                            $("#nu_man_day_"+j).css('border','1px solid red');                                            $("#nu_man_day_"+j).focus();                                            $("#nu_man_day_"+j).val('');                                                  man_day_IdNumValue=0;                                            break                                    }                                 }                                                                    /*==========  7 July 2014 =============*/                                                                                                   var nuProductOutstanding = $("#nu_product_outstanding_"+j).val();                               if (nuProductOutstanding =='') {                                   $("#nu_product_outstanding_"+j).css('border','1px solid red');                                   $("#nu_product_outstanding_"+j).focus();                                  nuProductOutstandingValue = 0;                                  break;                               }else{                                   nuProductOutstandingValue=1;                               }                                                                                                      var nuServiceOutstanding= $("#nu_service_outstanding_"+ j).val();                               if (nuServiceOutstanding =='') {                                   $("#nu_service_outstanding_"+j).css('border','1px solid red');                                   $("#nu_service_outstanding_"+j).focus();                                   nuServiceOutstandingValue = 0;                                   break;                               }else{                                   nuServiceOutstandingValue=1;                               }                                                               /*==========  7 July 2014 =============*/                }                                               if(parseInt(regionValue)==0)                {                    msg = 'Please select Region \n';                    alert(msg);                    return false;                  }else if(parseInt(checkNewregionValue)==0){                      msg = 'Region must be unique.\n';                    alert(msg);                    return false;                }                                if(parseInt(directIncomeValue)==0)                {                    msg = 'Please enter direct income.\n';                    alert(msg);                    return false;                  }else if(parseInt(directIncomeNumValue)==0){                       alert('Only positive integers are allowed for direct income.');                        return false;                }                                if(parseInt(directExpenceValue)==0)                {                    msg = 'Please enter direct expense.\n';                    alert(msg);                    return false;                  }else if(parseInt(directExpenceNumValue)==0){                        alert('Only positive integers are allowed for direct expense.');                         return false;                }                                   if(parseInt(indirectIncomeValue)==0)                {                    msg = 'Please enter indirect income.\n';                    alert(msg);                    return false;                  }else if(parseInt(indirectIncomeNumValue)==0){                         alert('Only positive integers are allowed for indirect income.');                         return false;                }                                if(parseInt(indirectExpenseValue)==0)                {                    msg = 'Please enter indirect expense.\n';                    alert(msg);                    return false;                  }else if(parseInt(indirectExpenseNumValue)==0){                         alert('Only positive integers are allowed for indirect expense.');                         return false;                }                                if(parseInt(hwCostValue)==0)                {                    msg = 'Please enter Oracle H/W cost.\n';                    alert(msg);                    return false;                  }else if(parseInt(hwCostValueNumValue)==0){                        alert('Only positive integers are allowed for Oracle H/W cost.');                         return false;                }                                if(parseInt(interRegionExpValue)==0)                {                    msg = 'Please enter inter region expense.\n';                    alert(msg);                    return false;                  }else if(parseInt(interRegionExpNumValue)==0){                       alert('Only positive integers are allowed for inter region expense.');                         return false;                }                                    if(parseInt(interRegionRevenueValue)==0)                {                    msg = 'Please enter inter region revenue.\n';                    alert(msg);                    return false;                  }//                else if(parseInt(interRegionRevenueNumValue)==0){//                        alert('Only positive integers are allowed for inter region revenue.');//                         return false;//                }                if(parseInt(prodRevenueValue)==0)                {                    msg = 'Please enter product revenue.\n';                    alert(msg);                    return false;                  }else if(parseInt(prodRevenueNumValue)==0){                        alert('Only positive integers are allowed for product revenue.');                         return false;                }                   if(parseInt(serviceRevenueValue)==0)                {                    msg = 'Please enter service revenue.\n';                    alert(msg);                    return false;                  }else if(parseInt(serviceRevenueNumValue)==0){                        alert('Only positive integers are allowed for service revenue.');                         return false;                }                                 if(parseInt(hwRevenueValue)==0)                {                    msg = 'Please enter Oracle H/W revenue.\n';                    alert(msg);                    return false;                  }else if(parseInt(hwRevenueNumValue)==0){                        alert('Only positive integers are allowed for Oracle H/W revenue.');                         return false;                }                                                 //alert(man_day_IdNumValue);                if(parseInt(man_day_IdValue)==0)                {                    msg = 'Please enter Number of Employee.\n';                    alert(msg);                    return false;                  }else if(parseInt(man_day_IdNumValue)==0){                        alert('Only positive integers are allowed for Number of Employee.');                         return false;                }                                    /*==========  7 July 2014 =============*/                                                       if (parseFloat(nuProductOutstandingValue)==0) {                            msg = 'Please enter Product Outstanding.\n';                            alert(msg);                            return false;                       }                      if (parseFloat(nuServiceOutstandingValue)==0) {                            msg = 'Please enter Service Outstanding.\n';                            alert(msg);                            return false;                      }                                               /*==========  7 July 2014 =============*/      }              function getTotalValue(row) {    var row = row;    var regexp = /^-?\d*\.{0,1}\d+$/;   // var regexp = /^[-100000000-9]+$/;    var directIncome = $("#direct_income_" + row).val();    if (!regexp.test(directIncome) || directIncome == NaN) {        $("#direct_income_" + row).val(0);        directIncome = 0;    }    var directExpense = $("#direct_expence_"+ row).val();    if (!regexp.test(directExpense) || directExpense == NaN) {        $("#direct_expence_" + row).val(0);        directExpense = 0;    }	var hwCost = $("#hw_cost_" + row).val();    if (!regexp.test(hwCost) || hwCost == NaN) {        $("#hw_cost_" + row).val(0);        hwCost = 0;    }    var directExpense = $("#direct_expence_"+row).val();		var indirectIncome = $("#indirect_income_" + row).val();    if (!regexp.test(indirectIncome) || indirectIncome == NaN) {        $("#indirect_income_" + row).val(0);        indirectIncome = 0;    }    var indirectExpense = $("#indirect_expense_" + row).val();    if (!regexp.test(indirectExpense) || indirectExpense == NaN) {        $("#indirect_expense_" + row).val(0);        indirectExpense = 0;    }    var interRegionExp = $("#inter_region_exp_" + row).val();    if (!regexp.test(interRegionExp) || interRegionExp == NaN) {        $("#inter_region_exp_" + row).val(0);        interRegionExp = 0;    }    var interRegionRevenue = $("#inter_region_revenue_" + row).val();    if (!regexp.test(interRegionRevenue) || interRegionRevenue == NaN) {        $("#inter_region_revenue_" + row).val(0);        interRegionRevenue = 0;    }    var prodRevenue = $("#prod_revenue_" + row).val();    if (!regexp.test(prodRevenue) || prodRevenue == NaN) {        $("#prod_revenue_" + row).val(0);        prodRevenue = 0;    }    var serviceRevenue = $("#service_revenue_" + row).val();    if (!regexp.test(serviceRevenue) || serviceRevenue == NaN) {        $("#service_revenue_" + row).val(0);        serviceRevenue = 0;    }    var hwRevenue = $("#hw_revenue_" + row).val();    if (!regexp.test(hwRevenue) || hwRevenue == NaN) {        $("#hw_revenue_" + row).val(0);        hwRevenue = 0;    }                /*==========  7 July 2014 =============*/     var nuServiceOutstanding= $("#nu_service_outstanding_"+ row).val();    if (!regexp.test(nuServiceOutstanding) || nuServiceOutstanding == NaN) {        $("#nu_service_outstanding_" + row).val(0);        nuServiceOutstanding = 0;    }       var nuProductOutstanding = $("#nu_product_outstanding_"+ row).val();    if (!regexp.test(nuProductOutstanding) || nuProductOutstanding == NaN) {        $("#nu_product_outstanding_" + row).val(0);        nuProductOutstanding = 0;    }     /*==========  7 July 2014 =============*/    	var sumExpense = parseFloat(directExpense) + parseFloat(indirectExpense);    /***************************************************************************/    var newTotalEx = parseFloat(sumExpense) + parseFloat(hwCost) + parseFloat(interRegionExp);    var TotalRevenue = parseFloat(interRegionRevenue) + parseFloat(prodRevenue) + parseFloat(serviceRevenue) + parseFloat(hwRevenue);    $("#direct_expence_"+row).val(directExpense);    var TotalMargin = parseFloat(TotalRevenue) - parseFloat(newTotalEx);    $("#total_revenue_"+row).val(TotalRevenue);    $("#margin_"+row).val(TotalMargin);    $("#total_exp_"+row).val(newTotalEx);	 }  function lessHwCost(row) {   var regexp = /^-?\d*\.{0,1}\d+$/;    var hwCost = $("#hw_cost_" + row).val();    if (!regexp.test(hwCost) || hwCost == NaN) {        $("#hw_cost_" + row).val(0);        hwCost = 0;    }	var directExpense = $("#direct_expence_"+ row).val();    if (!regexp.test(directExpense) || directExpense == NaN) {        $("#direct_expence_" + row).val(0);        directExpense = 0;    }    var directExpense = parseFloat(directExpense) - parseFloat(hwCost);	$("#direct_expence_"+row).val(directExpense);	getTotalValue(row); } function lessInterEx(row) {   var regexp = /^-?\d*\.{0,1}\d+$/;    var interRegionExp = $("#inter_region_exp_" + row).val();    if (!regexp.test(interRegionExp) || interRegionExp == NaN) {        $("#inter_region_exp_" + row).val(0);        interRegionExp = 0;    }	var directExpense = $("#direct_expence_"+ row).val();    if (!regexp.test(directExpense) || directExpense == NaN) {        $("#direct_expence_" + row).val(0);        directExpense = 0;    }    var directExpense = parseFloat(directExpense) - parseFloat(interRegionExp);    /***************************************************************************/    $("#direct_expence_"+row).val(directExpense);	getTotalValue(row); }